<body>
  <header>SRW+ System</header>
  <div class='sheet-row'>
    <label class='sheet-character-personal-info'>Pilot Name: <input type='text' name='attr_pilot_name'></label>
    <label class='sheet-character-personal-info'>Mecha Name: <input type='text' name='attr_mecha_name'></label>
    <label class='sheet-character-personal-info'>Level: <input type='number' name='attr_Level'></label>
  </div>
  <label class='sheet-character-personal-info sheet-type-label'>Character Type: </label>
  <!-- Cycling toggle button based on:
    -- https://wiki.roll20.net/CSS_Wizardry#Cycling_Button
    -- Tab view based on:
    -- https://wiki.roll20.net/CSS_Wizardry#Tabs
    -- It is necessary that the '-toggle' <input>s and <span>s be siblings of
    -- the '-content' <div>s.
    -->
  <input type='radio' class='sheet-type-toggle sheet-ace-toggle' name='attr_sheet_type' value='0' checked>
  <input type='radio' class='sheet-type-toggle sheet-elite-toggle' name='attr_sheet_type' value='1'>
  <input type='radio' class='sheet-type-toggle sheet-mook-toggle' name='attr_sheet_type' value='2'>
  <span class='sheet-type-toggle sheet-ace-toggle'>Ace</span>
  <span class='sheet-type-toggle sheet-elite-toggle'>Elite</span>
  <span class='sheet-type-toggle sheet-mook-toggle'>Mook</span>
  <br>
  <!-- Sheet Type Titles (not in use)
  <div class='sheet-tab-content sheet-mook'>
    <h2>Mook</h2>
  </div>
  <div class='sheet-tab-content sheet-elite'>
    <h2>Elite</h2>
  </div>
  <div class='sheet-tab-content sheet-ace'>
    <h2>Ace</h2>
  </div>
  -->
  <input type='radio' name='attr_sheet_tab' class='sheet-section-tab sheet-stats-tab' value='0' title='Statistics' checked>
  <input type='checkbox' class='sheet-spirit-toggle' name='attr_Spirit_Enabled' value='1'>
  <input type='radio' name='attr_sheet_tab' class='sheet-section-tab sheet-spirit-tab sheet-spirit-toggle-target' value='1' title='Spirits'>
  <input type='radio' name='attr_sheet_tab' class='sheet-section-tab sheet-attacks-tab' value='2' title='Attacks'>
  <input type='radio' name='attr_sheet_tab' class='sheet-section-tab sheet-abilities-tab' value='3' title='Abilities'>
  <div class='sheet-tab-content sheet-stats-tab'>
    <h2>Statistics</h2>
    <div class='sheet-row'>
      <h3>Resources</h3>
      <div class='sheet-statistic-row'>
        <div class='sheet-resource-cell'>
          <label class='sheet-resource-label'>Curr. HP</label>
          <label class='sheet-resource-label'>/</label>
          <label class='sheet-resource-label'>Max HP</label>
        </div>
        <div class='sheet-resource-cell'>
          <input value='0' type='number' title='@{HP}' name='attr_HP'>
          <span>/</span>
          <input readonly type='number' title='@{HP|max}' name='attr_HP_max'>
        </div>
      </div>
      <input class='sheet-will-toggle' type='checkbox' name='attr_Will_Enabled' value='1'>
      <div class='sheet-statistic-row sheet-will-toggle-target'>
        <div class='sheet-resource-cell'>
          <label class='sheet-resource-label'>Curr. Will</label>
          <label class='sheet-resource-label'>/</label>
          <label class='sheet-resource-label'>Max Will</label>
        </div>
        <div class='sheet-resource-cell'>
          <input value='0' type='number' title='@{Will}' name='attr_Will'>
          <span>/</span>
          <input readonly type='number' title='@{Will|max}' name='attr_Will_max'>
        </div>
      </div>
      <div class='sheet-statistic-row'>
        <div class='sheet-resource-cell'>
          <label class='sheet-resource-label'>Curr. EN</label>
          <label class='sheet-resource-label'>/</label>
          <label class='sheet-resource-label'>Max EN</label>
        </div>
        <div class='sheet-resource-cell'>
          <input value='0' type='number' title='@{Energy}' name='attr_Energy'>
          <span>/</span>
          <input readonly type='number' title='@{Energy|max}' name='attr_Energy_max'>
        </div>
      </div>
      <input class='sheet-spirit-toggle' type='checkbox' name='attr_Spirit_Enabled' value='1'>
      <div class='sheet-statistic-row sheet-spirit-toggle-target'>
        <div class='sheet-resource-cell'>
          <label class='sheet-resource-label'>Curr. SP</label>
          <label class='sheet-resource-label'>/</label>
          <label class='sheet-resource-label'>Max SP</label>
        </div>
        <div class='sheet-resource-cell'>
          <input value='0' type='number' title='@{Spirit}' name='attr_Spirit'>
          <span>/</span>
          <input readonly type='number' title='@{Spirit|max}' name='attr_Spirit_max'>
        </div>
      </div>
    </div>
    <div class=sheet-row>
      <h3>Attributes</h3>
      <span>Unspent Attribute Points: </span><span name='attr_unspent_attribute_points'></span>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Base HP</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{HP_base}' name='attr_HP_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_HP_base' value='30'><span></span>
      </div>
      <input class='sheet-will-toggle' type='checkbox' name='attr_Will_Enabled' value='1'>
      <div class='sheet-statistic-row sheet-will-toggle-target'>
        <label class='sheet-attribute-label'>Base Will</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Will_base}' name='attr_Will_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Will_base' value='30'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='31'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='32'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='33'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='34'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='35'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='36'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='37'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='38'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='39'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='40'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='41'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='42'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='43'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='44'><span></span>
        <input class='sheet-stat-point-buy go-beyond-the-impossible' type='radio' name='attr_Will_base' value='45'><span></span>
      </div>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Base Energy</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Energy_base}' name='attr_Energy_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Energy_base' value='30'><span></span>
      </div>
      <input class='sheet-spirit-toggle' type='checkbox' name='attr_Spirit_Enabled' value='1'>
      <div class='sheet-statistic-row sheet-spirit-toggle-target'>
        <label class='sheet-attribute-label'>Base Spirit</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Spirit_base}' name='attr_Spirit_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Spirit_base' value='30'><span></span>
      </div>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Armor</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Armor_base}' name='attr_Armor_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Armor_base' value='30'><span></span>
      </div>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Accuracy</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Accuracy_base}' name='attr_Accuracy_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Accuracy_base' value='30'><span></span>
      </div>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Evade</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Evade_base}' name='attr_Evade_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Evade_base' value='30'><span></span>
      </div>
      <div class='sheet-statistic-row'>
        <label class='sheet-attribute-label'>Skill</label>
        <input readonly class='sheet-stat-point-base' type='text' title='@{Skill_base}' name='attr_Skill_base' value='1'>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='1' checked><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='2'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='3'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='4'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='5'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='6'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='7'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='8'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='9'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='10'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='11'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='12'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='13'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='14'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='15'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='16'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='17'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='18'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='19'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='20'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='21'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='22'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='23'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='24'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='25'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='26'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='27'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='28'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='29'><span></span>
        <input class='sheet-stat-point-buy' type='radio' name='attr_Skill_base' value='30'><span></span>
      </div>
    </div>
  </div>
  <div class='sheet-tab-content sheet-spirit-tab'><h2>Spirits</h2></div>
  <div class='sheet-tab-content sheet-attacks-tab'><h2>Attacks</h2></div>
  <div class='sheet-tab-content sheet-abilities-tab'><h2>Abilities</h2></div>
  <span class='sheet-version-number'><input type='string' name='sheet-version-number'></span>
</body>


<script type='text/worker'>
/* Use common functions to calculate derived stats. It's not strictly
 * necessary, but it means we don't have to update a macro inline, buried in
 * html, every time the derived stat formula changes. This should only be used
 * for rarely updated stats, like maximum values of resource pools.
 */

const SHEET_TYPES = {
  ACE: '0',
  ELITE: '1',
  MOOK: '2'
};

const SHEET_TABS = {
  STATISTICS: '0',
  SPIRITS: '1',
  ATTACKS: '2',
  ABILITIES: '3'
};

const TOGGLE_STATES = {
  OFF: '0',
  ON: '1'
};

const ATTRIBUTE_POINTS_PER_STEP = 10;

const BASE_ATTRIBUTE_POINTS = 100;

var calculateMaxWill = function() {
  getAttrs(['Will_base'], function(values) {
    setAttrs({ Will_max: values.Will_base || 0 });
  });
};

var calculateMaxSpirit = function() {
  getAttrs(['Spirit_base'], function(values) {
    setAttrs({ Spirit_max: values.Spirit_base || 0 });
  });
};

var calculateMaxHP = function() {
  getAttrs(['HP_base'], function(values) {
    setAttrs({ HP_max: values.HP_base || 0 });
  });
};

var calculateMaxEnergy = function() {
  getAttrs(['Energy_base'], function(values) {
    setAttrs({ Energy_max: values.Energy_base || 0 });
  });
};

var calculateTriangularNumber = function(input) {
  const number = Number.parseInt(input);
  return (number * (number + 1))/2;
};

var calculateUnspentAttributePoints = function() {
  getAttrs([
    'Energy_base',
    'Will_base',
    'Spirit_base',
    'HP_base',
    'Armor_base',
    'Evade_base',
    'Skill_base',
    'Accuracy_base',
    'Level'
  ], function(values) {
    const maxPoints = BASE_ATTRIBUTE_POINTS + values.Level * ATTRIBUTE_POINTS_PER_STEP;

    // Example calculation
    const energyUsed = calculateTriangularNumber(values.Energy_base);
    const willUsed = calculateTriangularNumber(values.Will_base);
    const spiritUsed = calculateTriangularNumber(values.Spirit_base);
    const hPUsed = calculateTriangularNumber(values.HP_base);
    const armorUsed = calculateTriangularNumber(values.Armor_base);
    const evadeUsed = calculateTriangularNumber(values.Evade_base);
    const skillUsed = calculateTriangularNumber(values.Skill_base);
    const accuracyUsed = calculateTriangularNumber(values.Accuracy_base);

    const totalUsed = energyUsed + willUsed + spiritUsed + hPUsed + armorUsed + evadeUsed + skillUsed + accuracyUsed;

    setAttrs({unspent_attribute_points: (maxPoints - totalUsed)});
  });
};

on('sheet:opened', function() {
  // Initialize all stats on sheet open.
  calculateMaxWill();
  calculateMaxSpirit();
  calculateMaxHP();
  calculateMaxEnergy();
  calculateUnspentAttributePoints();
});

on('change:will_base', function() {
  calculateMaxWill();
  calculateUnspentAttributePoints();
});

on('change:spirit_base', function() {
  calculateMaxSpirit();
  calculateUnspentAttributePoints();
});

on('change:hp_base', function() {
  calculateMaxHP();
  calculateUnspentAttributePoints();
});

on('change:energy_base', function() {
  calculateMaxEnergy();
  calculateUnspentAttributePoints();
});

on('change:armor_base', function() {
  calculateUnspentAttributePoints();
});

on('change:skill_base', function() {
  calculateUnspentAttributePoints();
});

on('change:evade_base', function() {
  calculateUnspentAttributePoints();
});

on('change:accuracy_base', function() {
  calculateUnspentAttributePoints();
});

on('change:level', function() {
  calculateUnspentAttributePoints();
});

on('change:sheet_type', function() {
  getAttrs(['sheet_type', 'sheet_tab'], function(values) {
    switch (values.sheet_type) {
      case SHEET_TYPES.ELITE:
        setAttrs({
          Will_Enabled: TOGGLE_STATES.OFF,
          Spirit_Enabled: TOGGLE_STATES.ON
        });
        break;

      case SHEET_TYPES.MOOK:
        setAttrs({
          Will_Enabled: TOGGLE_STATES.OFF,
          Spirit_Enabled: TOGGLE_STATES.OFF,
          // If showing the spirit tab when changing to mook, change back to stats tab
          sheet_tab: values.sheet_tab === SHEET_TABS.SPIRITS ? SHEET_TABS.STATISTICS : values.sheet_tab
        });
        break;

      case SHEET_TYPES.ACE:
        setAttrs({
          Will_Enabled: TOGGLE_STATES.ON,
          Spirit_Enabled: TOGGLE_STATES.ON
        });
        break;

      default:
        break;
    }
  });
});
</script>
